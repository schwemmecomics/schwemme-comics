{{ define "main" }}
<article style="max-width: 800px; margin: 40px auto; padding: 0 20px; line-height: 1.8; font-size: 1.1em; text-align: left;">
    <header style="margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 20px;">
        <h1 style="font-size: 2.5em; margin-bottom: 10px;">{{ .Title }}</h1>
        <time style="color: #888;">{{ .Date.Format "02.01.2006" }}</time>
    </header>

    <div class="news-post-content">
        {{ .Content }}
    </div>

    {{/* Share Section*/}}
<div class="share-container" style="margin: 20px 0; text-align: center;">
    {{/* Der Button mit deinem einen Icon */}}
    <button id="shareBtn" style="background: none; border: none; cursor: pointer; padding: 10px;">
        <img src="{{ "images/share-icon.png" | relURL }}" alt="Teilen" style="width: 40px; height: auto;">
        <p style="margin: 0; font-size: 0.8em; color: #666;">Comic teilen</p>
    </button>
</div>

<script>
document.getElementById('shareBtn').addEventListener('click', async () => {
    const shareData = {
        title: '{{ .Title }}',
        text: 'Schau dir diesen Comic an!',
        url: '{{ .Permalink }}'
    };

    try {
        // Prüft, ob der Browser das systemeigene Teilen unterstützt
        if (navigator.share) {
            await navigator.share(shareData);
        } else {
            // Fallback: Falls nicht (z.B. am PC), wird der Link einfach kopiert
            await navigator.clipboard.writeText('{{ .Permalink }}');
            alert('Link wurde kopiert!');
        }
    } catch (err) {
        console.log('Teilen abgebrochen oder Fehler:', err);
    }
});
</script>
    
    {{/* Comments */}}
<div class="comments-wrapper" style="margin-top: 60px; padding: 20px; border-top: 2px solid #eee; text-align: left;">
    <h3 style="text-align: center;">Kommentare</h3>
    
    <div id="cusdis_thread"
      data-host="https://cusdis.com"
      data-app-id="24970c43-2814-46a1-ad48-67de2a7d85c2"
      data-page-id="{{ .File.UniqueID }}"
      data-page-url="{{ .Permalink }}"
      data-page-title="{{ .Title }}"
      data-theme="light"
      data-lang="{{ .Lang | default "de" }}"
    ></div>

<script>
  // Dieser kleine Zusatz zwingt Cusdis, die Sprache neu zu bewerten
  {{ if eq .Lang "de" }}
  window.CUSDIS_LOCALE = {
    "powered_by": "Kommentare betrieben mit Cusdis",
    "post_comment": "Kommentar abschicken",
    "placeholder": "Schreib etwas...",
    "email": "Email (optional)",
    "nickname": "Spitzname",
    "reply": "Antworten",
    "mod_badge": "Autor",
    "load_more": "Mehr laden"
  }
  {{ else }}
  window.CUSDIS_LOCALE = {
    "powered_by": "Comments powered by Cusdis",
    "post_comment": "Submit",
    "placeholder": "Write something...",
    "email": "Email (optional)",
    "nickname": "Nickname",
    "reply": "Reply",
    "mod_badge": "Author",
    "load_more": "Load more"
  }
  {{ end }}
</script>
    
    {{/* Das Cusdis-Skript */}}
    <script async defer src="{{ "js/cusdis.js" | relURL }}"></script>
    
    <footer style="margin-top: 50px; padding-top: 20px; border-top: 1px solid #eee;">
        {{/* Dieser Link sucht dynamisch die News-Übersicht der aktuellen Sprache */}}
        {{ with .Site.GetPage "/news" }}
            <a href="{{ .RelPermalink }}" style="color: #b58900; text-decoration: none; font-weight: bold;">
                {{ i18n "back_to_news" }}
            </a>
        {{ end }}
    </footer>
</article>
{{ end }}
