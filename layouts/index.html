{{ define "main" }}
<section class="home-container" style="max-width: 1000px; margin: 0 auto; text-align: center; padding: 20px;">
    
    {{/* Den absolut neuesten Comic holen */}}
    {{ $comics := where .Site.RegularPages "Section" "comics" }}
    {{ $latest := index $comics.ByDate.Reverse 0 }}

    {{ if $latest }}
        <div class="featured-comic" style="margin-bottom: 60px;">
            <h2 style="font-size: 2em; margin-bottom: 10px;">Neuester Strip: {{ $latest.Title }}</h2>
            <p style="color: #666; margin-bottom: 20px;">Veröffentlicht am {{ $latest.Date.Format "02.01.2006" }}</p>
            
            <a href="{{ $latest.Permalink }}">
                {{ $comicImg := $latest.Resources.GetMatch (printf "comic.%s.*" .Lang) | default ($latest.Resources.GetMatch "comic.*") }}
                {{ if $comicImg }}
                    {{/* Den Haupt-Comic lassen wir groß, aber optimieren ihn für die Web-Ansicht */}}
                    {{ $large := $comicImg.Resize "1200x" }}
                    <img src="{{ $large.RelPermalink }}" alt="{{ $latest.Title }}" style="max-width: 100%; height: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border-radius: 12px;">
                {{ end }}
            </a>
        </div>
    {{ end }}

   {{/* NEU: Die aktuellste News-Meldung anzeigen */}}
    {{ $news := where .Site.RegularPages "Section" "news" }}
    {{ range first 1 $news.ByDate.Reverse }}
        <div class="latest-news-home" style="max-width: 800px; margin: 40px auto; background: #fdf6e3; border-left: 5px solid #b58900; padding: 20px; border-radius: 8px; text-align: left; box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
            <small style="text-transform: uppercase; color: #b58900; font-weight: bold; letter-spacing: 1px;">Neuigkeiten</small>
            <h2 style="margin: 5px 0 10px 0; font-size: 1.5em;"><a href="{{ .RelPermalink }}" style="text-decoration: none; color: #333;">{{ .Title }}</a></h2>
            <div style="line-height: 1.6; color: #444;">
                {{ .Summary }}
            </div>
           <a href="{{ .RelPermalink }}" style="display: inline-block; margin-top: 10px; font-weight: bold; color: #b58900;"> {{ i18n "read_more" }} →</a>
        </div>
    {{ end }}

    <hr style="border: 0; border-top: 2px solid #f0f0f0; margin: 60px 0;">
    
    <hr style="border: 0; border-top: 2px solid #f0f0f0; margin: 60px 0;">

    {{/* Archiv-Galerie mit automatischem Zuschnitt */}}
    <h3 style="margin-bottom: 30px;">Bisherige Strips</h3>
    <div class="comic-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px;">
        {{ range (after 1 $comics.ByDate.Reverse) }}
            <div class="archive-card" style="background: #fff; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: transform 0.2s;">
                <a href="{{ .Permalink }}" style="text-decoration: none; color: inherit;">
                    {{ $thumbRaw := .Resources.GetMatch "comic.*" }}
                    {{ if $thumbRaw }}
                        {{/* Hier passiert die Magie: Zuschnitt auf 400x300 Pixel, Fokus auf die Mitte */}}
                        {{ $thumb := $thumbRaw.Fill "400x300 Center" }}
                        <img src="{{ $thumb.RelPermalink }}" style="width: 100%; height: auto; display: block;">
                    {{ end }}
                    <div style="padding: 15px;">
                        <strong style="display: block; margin-bottom: 5px;">{{ .Title }}</strong>
                        <small style="color: #888;">#{{ .File.ContentBaseName }}</small>
                    </div>
                </a>
            </div>
        {{ end }}
    </div>
</section>
{{ end }}
