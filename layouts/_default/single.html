{{ define "main" }}
<article class="comic-container">
  <h1>{{ .Title }}</h1>
  
  <div class="comic-image">
    <img src="{{ .Params.comic_file | relURL }}" alt="{{ .Title }}" style="max-width:100%; height:auto;">
  </div>

  <nav class="comic-nav">
    {{ $comics := where .Site.RegularPages "Section" "comics" }}
    {{ if $comics }}
      <a href="{{ (index $comics.ByDate 0).Permalink }}"><img src="{{ .Site.Params.icon_first | relURL }}" alt="First"></a>
    {{ end }}
    
    {{ if .PrevInSection }}
      <a href="{{ .PrevInSection.Permalink }}"><img src="{{ .Site.Params.icon_prev | relURL }}" alt="Previous"></a>
    {{ else }}
      <img src="{{ .Site.Params.icon_prev | relURL }}" alt="Previous" style="opacity: 0.3;">
    {{ end }}

    <a href="#" id="random-btn">
    <img src="{{ .Site.Params.icon_random | relURL }}" alt="Random">
</a>

    {{ if .NextInSection }}
      <a href="{{ .NextInSection.Permalink }}"><img src="{{ .Site.Params.icon_next | relURL }}" alt="Next"></a>
    {{ else }}
      <img src="{{ .Site.Params.icon_next | relURL }}" alt="Next" style="opacity: 0.3;">
    {{ end }}

    {{ if $comics }}
      <a href="{{ (index $comics.ByDate.Reverse 0).Permalink }}"><img src="{{ .Site.Params.icon_last | relURL }}" alt="Last"></a>
    {{ end }}
  </nav>

  <section class="comic-header-info" style="margin-top: 30px; margin-bottom: 20px; border-top: 1px solid #eee; padding-top: 20px;">
    {{/* Die Nummer aus dem Ordnernamen und der Titel aus dem Frontmatter */}}
    <h2 style="font-size: 1.6em; margin-bottom: 10px;">
      #{{ .File.ContentBaseName }} – {{ .Title }}
    </h2>
  
    {{/* Hier bleiben deine Notizen erhalten, aber ohne die alte H3-Überschrift */}}
    <p style="font-style: italic; color: #555; max-width: 800px; margin: 0 auto;">
      {{ if eq .Site.Language.Lang "de" }}{{ .Params.note_de }}{{ else }}{{ .Params.note_en }}{{ end }}
    </p>
  </section>
</article>

<script>
  // Hugo erstellt hier eine Liste aller Comic-Seiten
  const comicUrls = [
    {{ range (where .Site.RegularPages "Section" "comics") }}
      "{{ .Permalink }}",
    {{ end }}
  ];

  document.getElementById("random-btn").addEventListener("click", function(e) {
    e.preventDefault(); // Verhindert, dass die Seite einfach nur nach oben springt
    if (comicUrls.length > 0) {
      // Wählt eine zufällige URL aus der Liste aus
      const randomComic = comicUrls[Math.floor(Math.random() * comicUrls.length)];
      window.location.href = randomComic;
    }
  });
</script>
{{ end }}
